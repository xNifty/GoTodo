html[data-theme="dark"] #email.form-control-plaintext {
    color: #fff !important;
}
html[data-theme="light"] #email.form-control-plaintext {
    color: #000 !important;
}
@import url("https://fonts.googleapis.com/css2?family=Fira+Code:wght@400&display=swap");

:root {
    /* Light mode (default) variables */
    --body-bg: #f8f9fa;
    --text-color: #212529;
    --table-header-bg: #007bff;
    --table-header-text: #ffffff;
    --table-row-even: #f2f2f2;
    --table-row-hover: #e9ecef;
    --table-box-shadow: rgba(0, 0, 0, 0.1);
    --box-bg: #ffffff;
    --box-border: #ccc;
    --sidebar-bg: #f8f9fa;
    --navbar-bg: #f8f9fa;
    --navbar-text: #212529;
    --container-bg: #ffffff;
    --form-control-bg: #ffffff;
    --form-control-text: #212529;
    --transition-time: 0.3s;
}

[data-theme="dark"] {
    /* Dark mode variables */
    --body-bg: #121212;
    --text-color: #e9ecef;
    --table-header-bg: #0d6efd;
    --table-header-text: #ffffff;
    --table-row-even: #2a2a2a;
    --table-row-hover: #3a3a3a;
    --table-box-shadow: rgba(0, 0, 0, 0.3);
    --box-bg: #2a2a2a;
    --box-border: #444;
    --sidebar-bg: #2a2a2a;
    --navbar-bg: #2a2a2a;
    --navbar-text: #e9ecef;
    --container-bg: #2a2a2a;
    --form-control-bg: #333;
    --form-control-text: #e9ecef;
}

/* Body styles */
body {
    font-family: "Fira Code", monospace; /* Custom font */
    background-color: var(--body-bg);
    color: var(--text-color);
    line-height: 1.6; /* Matches Bootstrap's default */
    transition: background-color var(--transition-time), color var(--transition-time);
}

/* Table styling */
table {
    border-collapse: collapse;
    box-shadow: 0 4px 8px var(--table-box-shadow);
    table-layout: fixed;
    width: 100%;
    max-width: 100%;
    background-color: var(--box-bg);
    transition: background-color var(--transition-time);
}

thead {
    background-color: var(--table-header-bg);
    color: var(--table-header-text);
}

thead th {
    text-transform: uppercase;
    font-weight: bold; /* Matches Bootstrap table head font weight */
}

tbody tr {
    transition: background-color var(--transition-time), color var(--transition-time);
}

tbody tr:nth-child(even) {
    background-color: var(--table-row-even);
}

tbody tr:hover {
    background-color: var(--table-row-hover);
    cursor: pointer; /* Indicate interactivity */
}

td,
th {
    padding: 12px 15px;
    text-align: left; /* Ensures left alignment for all content */
    word-wrap: break-word;
    overflow-wrap: break-word;
    white-space: normal;
    border-bottom: 1px solid var(--box-border); /* Add bottom border to cells */
    transition: background-color var(--transition-time), color var(--transition-time), border-color var(--transition-time);
}

th.description-column {
    max-width: 25em;
    /*width: 25em;*/
}

td.description-column {
    max-width: none; /* allow description and title columns to size naturally */
}

th.id-column,
td.id-column {
    width: 5%; /* Adjust as necessary for ID column */
    max-width: 50px; /* Prevent excessive width */
    text-align: center; /* Center-align for better presentation */
}

th.status-column,
td.status-column {
    width: 10%; /* Limit width for Status column */
    max-width: 100px;
    /*text-align: center;*/
}

th.delete-column,
td.delete-column {
    width: 10%; /* Limit width for Delete column */
    max-width: 80px;
    /*text-align: center;*/
}

.row {
    overflow-x: auto;
}

.col-lg-10 {
    padding: 0;
}

/* Responsive table tweaks */
@media (max-width: 600px) {
    table {
        width: 100%;
    }

    thead {
        display: none; /* Simplifies table on small screens */
    }

    tbody tr {
        display: block;
        margin-bottom: 15px;
    }

    td {
        display: block;
        padding-left: 50%;
        position: relative;
        text-align: left;
    }

    td::before {
        content: attr(data-label);
        position: absolute;
        left: 15px;
        width: calc(50% - 15px);
        font-weight: bold;
    }

    /* Hide drag handle on very small screens to avoid overlap */
    .drag-column {
        display: none;
    }

    /* Make action buttons stack nicely */
    .status-column, .delete-column {
        display: inline-block;
        margin-top: 0.5rem;
        margin-right: 0.5rem;
    }

    .drag-handle {
        margin-right: 0.5rem;
    }
}

/* Touch-device override: ensure on phones and touch devices the invite details
   remain hidden unless expanded, and emails are left-aligned. Placed late
   to outrank earlier tablet/desktop rules. */
@media (pointer: coarse) {
    /* Touch devices: keep title left-aligned but do not hide details —
       show the full 3-row layout (drag/title, description, actions). */
    .invite-list-card tbody tr td.title-column {
        display: block !important;
        width: 100% !important;
        text-align: left !important;
    }
    .invite-list-card .title-column .form-control,
    .invite-list-card .title-column span.task-toggle {
        text-align: left !important;
        position: static !important;
    }
}

/* Match profile's phone layout for create-invite page at 420px and below */
@media (max-width: 420px) {
    body.create-invite-page .container {
        padding-left: 0.5rem !important;
        padding-right: 0.5rem !important;
    }
    body.create-invite-page .card {
        width: 100% !important;
        max-width: 100% !important;
        box-sizing: border-box !important;
        margin: 0 auto !important;
    }
    body.create-invite-page .form-control,
    body.create-invite-page .form-select,
    body.create-invite-page .form-control-plaintext {
        width: 100% !important;
        box-sizing: border-box !important;
    }

    /* Force invite list rows to be full-width blocks like profile card rows */
    .invite-list-card tbody tr {
        display: block !important;
        width: 100% !important;
        margin-bottom: 0.6rem !important;
        padding: 0.6rem !important;
    }

    /* Ensure title/email left-aligned and occupying full width */
    .invite-list-card .title-column,
    .invite-list-card .title-column .form-control,
    .invite-list-card .title-column span.task-toggle {
        text-align: left !important;
        display: block !important;
        width: 100% !important;
    }

    /* Reposition chevron to the far right inside the title row */
    .invite-list-card .title-column { position: relative; }
    .invite-list-card .title-column .task-toggle::after {
        position: absolute !important;
        right: 0.6rem !important;
        top: 50% !important;
        transform: translateY(-50%) !important;
    }

    /* Hide details by default unless expanded */
    .invite-list-card tbody tr:not(.expanded) .desc-column,
    .invite-list-card tbody tr:not(.expanded) .status-column,
    .invite-list-card tbody tr:not(.expanded) .delete-column {
        display: none !important;
    }

    /* Reveal details when expanded */
    .invite-list-card tbody tr.expanded .desc-column,
    .invite-list-card tbody tr.expanded .status-column,
    .invite-list-card tbody tr.expanded .delete-column {
        display: block !important;
    }
}

/* Polished styling for expanded invite accordion content */
.invite-list-card tbody tr.expanded {
    padding-bottom: 0.8rem !important;
}
.invite-list-card tbody tr.expanded .desc-column {
    margin-top: 0.6rem;
    padding: 0.6rem 0.75rem;
    background: rgba(0,0,0,0.06);
    border-radius: 6px;
    border: 1px solid rgba(255,255,255,0.03);
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
    font-size: 0.95rem;
    word-break: break-all;
}
.invite-list-card tbody tr.expanded .status-column {
    margin-top: 0.6rem;
    display: inline-block;
}
.invite-list-card tbody tr.expanded .delete-column {
    margin-top: 0.6rem;
    display: flex;
    gap: 0.5rem;
    align-items: center;
    flex-wrap: wrap;
}

/* Actions column alignment and spacing */
.actions-column {
    text-align: left; /* ensure left alignment */
}
.actions-column .status-column,
.actions-column .delete-column,
.actions-column .edit-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
}

/* Make the status toggle visually wider and more toggle-like */
.actions-column .status-column {
    min-width: 64px; /* give it enough horizontal space */
    height: 34px; /* pill-like height */
    padding: 0 12px; /* horizontal padding for pill shape */
    border-radius: 20px; /* rounded pill */
    display: inline-flex !important;
    align-items: center;
    justify-content: center;
}
.actions-column .status-column .bi {
    font-size: 1.15rem; /* slightly larger icon */
}

/* Increase contrast on danger buttons to ensure icon visibility */
.actions-column .status-column.bg-danger {
    color: #fff; /* ensure icon/text are visible */
}
.invite-list-card tbody tr.expanded .delete-column .btn {
    min-width: 44px;
}

/* Ensure action buttons are compact and icon-centered when icon-only */
.invite-list-card .delete-column .btn i {
    font-size: 1.05rem;
}
.invite-list-card .delete-column .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.45rem 0.55rem;
}

/* On wider screens, keep action buttons compact and side-by-side */
@media (min-width: 421px) {
    .invite-list-card tbody tr.expanded .delete-column {
        display: flex;
        justify-content: flex-start;
        gap: 0.5rem;
        align-items: center;
    }
    .invite-list-card tbody tr.expanded .status-column {
        margin-right: 1rem;
    }
}

/* Add subtle separators for readability */
.invite-list-card tbody tr + tr { margin-top: 0.45rem; }

/* Ensure create-invite page uses full-width cards like profile on small screens */
@media (max-width: 600px) {
    body.create-invite-page .container {
        padding-left: 0.6rem !important;
        padding-right: 0.6rem !important;
    }
    body.create-invite-page .card {
        width: 100% !important;
        max-width: 100% !important;
        box-sizing: border-box !important;
    }
    /* Ensure each invite title (email) is full-width and left-aligned */
    .invite-list-card .title-column span.task-toggle {
        display: block !important;
        width: 100% !important;
        text-align: left !important;
        padding-right: 2.2rem !important; /* avoid overlap with chevron */
    }
    .invite-list-card .title-column .form-control {
        text-align: left !important;
    }
    /* Make chevron sit at the far right inside the title row */
    .invite-list-card .title-column .task-toggle::after {
        position: absolute !important;
        right: 0.6rem !important;
        top: 50% !important;
        transform: translateY(-50%) !important;
    }
}

/* Compact card-style for small/medium screens */
@media (max-width: 768px) {
    /* Make each row a compact horizontal card when collapsed (flex),
       and allow switching to block when expanded. */
    tbody tr {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.6rem;
        background-color: var(--box-bg);
        border: 1px solid var(--box-border);
        border-radius: 6px;
        padding: 0.4rem;
        box-shadow: 0 4px 8px rgba(0,0,0,0.06);
    }

    /* Stack cells and show label above value */
    td {
        /* default for collapsed: let cells behave inline inside the flex row */
        display: inline-block;
        padding: 0.12rem 0.25rem;
        position: relative;
        text-align: left;
        border: none;
        vertical-align: middle;
    }

    /* Hide injected labels on small screens — rows are explicit (title, desc, actions) */
    td::before {
        display: none;
    }

    [data-theme="dark"] td::before {
        color: #adb5bd;
    }

    /* Emphasize title */
    .description-column {
        font-size: 0.95rem;
        font-weight: 700;
    }

    /* Ensure the favorite/star button and title align on one line */
    .description-column > .btn,
    .description-column > .btn-link {
        vertical-align: middle;
        display: inline-flex;
        align-items: center;
        padding: 0;
        margin-right: 0.35rem;
    }

    .description-column .bi {
        margin-right: 0.35rem;
        vertical-align: middle;
    }

    .date-added {
        font-size: 0.78rem;
        color: #6c757d;
    }

    [data-theme="dark"] .date-added {
        color: #adb5bd;
    }

    /* Action buttons: align to right on wider small screens */
    td[data-label="Status"], td[data-label="Delete"] {
        text-align: right;
    }

    .status-column, .delete-column {
        display: inline-block;
        margin-left: 0.35rem;
        padding: 0.2rem 0.45rem;
        font-size: 0.78rem;
        border-radius: 0.35rem;
    }

    /* On very small screens make buttons full-width stacked */
    @media (max-width: 420px) {
        .status-column, .delete-column {
            display: block;
            width: 100%;
            margin-left: 0;
            margin-top: 0.25rem;
            padding: 0.35rem 0.5rem;
            font-size: 0.82rem;
        }
    }

    /* Hide drag column on small/medium screens to save space */
    .drag-column {
        display: inline-table; /* keep drag visible */
        vertical-align: middle;
    }

    /* MOBILE: always show description/date/actions; present as full-width rows */
    td.desc-column,
    td.date-added,
    td[data-label="Status"],
    td[data-label="Delete"] {
        display: block;
        flex-basis: 100%;
        width: 100%;
        padding-top: 0.4rem;
    }

    /* Keep title visible */
    td.title-column {
        display: inline-block;
        flex: 1 1 auto; /* allow title to take remaining width */
    }

    /* hide the label for the title cell in compact mode */
    td.title-column::before { display: none; }

    /* When a row is expanded, reveal details but keep drag+title inline on the first row.
       Use a flex wrap layout so title and drag handle remain on the same line, while
       description/date/action cells break to a new full-width row below. */
    tr.expanded {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 0.35rem;
        padding: 0.25rem 0.3rem;
    }

    /* Default cell layout inside expanded row: keep title and drag inline, make details full-width */
    tr.expanded td {
        display: inline-flex;
        align-items: center;
        padding: 0.12rem 0.25rem;
        border: none;
        vertical-align: middle;
    }

    /* Make the description, date and action cells occupy full width below the title row */
    tr.expanded td.desc-column,
    tr.expanded td.date-added,
    tr.expanded td[data-label="Status"],
    tr.expanded td[data-label="Delete"] {
        display: block;
        flex-basis: 100%;
        width: 100%;
        padding-top: 0.5rem;
    }

    /* Ensure the title and drag columns stay together on one line */
    tr.expanded td.title-column,
    tr.expanded td.drag-column {
        flex: 0 1 auto;
    }

    /* hide the injected labels for action/date cells when expanded to avoid duplicate text */
    tr.expanded td[data-label="Status"]::before,
    tr.expanded td[data-label="Delete"]::before,
    tr.expanded td.date-added::before {
        display: none;
    }
    /* also hide description label when expanded */
    tr.expanded td.desc-column::before {
        display: none;
    }

    /* add spacing above action buttons in expanded state */
    tr.expanded .status-column,
    tr.expanded .delete-column {
        margin-top: 0.5rem;
    }

    /* Make action buttons full-width and larger when a row is expanded for easier touch targets */
    tr.expanded .status-column,
    tr.expanded .delete-column {
        display: block;
        width: 100%;
        box-sizing: border-box;
        padding: 0.5rem 0.6rem;
        font-size: 0.92rem;
        text-align: center;
        margin-left: 0;
    }

        /* Stronger override to ensure Bootstrap or other styles don't prevent full-width behavior */
        tbody tr.expanded td .status-column,
        tbody tr.expanded td .delete-column {
            display: block !important;
            width: 100% !important;
            padding: 0.5rem 0.6rem !important;
            font-size: 0.92rem !important;
            text-align: center !important;
            margin-left: 0 !important;
        }

    /* Favorite button and title inline alignment */
    .title-column .favorite-btn {
        margin-right: 0.45rem;
        padding: 0;
        line-height: 1;
        vertical-align: middle;
    }

    .title-column .title-text {
        display: inline-block;
        font-weight: 700;
        font-size: 0.98rem;
        color: var(--text-color);
        text-align: left;
        vertical-align: middle;
        cursor: pointer;
    }

    /* Ensure drag handle and title sit on the first line while description/actions
       occupy full-width rows below on mobile */
    .drag-column {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex: 0 0 auto;
        width: 32px;
        min-width: 32px;
        padding: 0 0.25rem;
        box-sizing: border-box;
    }

    td.title-column {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        flex: 1 1 auto;
        min-width: 0;
    }

    /* Remove extra link/button styles for compact title toggle */
    .task-toggle {
        background: transparent;
        border: none;
        padding: 0;
        margin: 0;
        text-decoration: none;
        color: inherit;
    }

    /* Make the task title look like a control in compact mode (no underline),
       with a chevron indicator that flips when expanded. */
    .task-toggle {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        cursor: pointer;
        border-radius: 4px;
        padding: 0.08rem 0.18rem;
        transition: background-color 0.15s ease, transform 0.15s ease;
    }

    .task-toggle:hover,
    .task-toggle:focus {
        background-color: rgba(0,0,0,0.04);
        outline: none;
    }

    .task-toggle::after {
        /* remove collapse chevron now that rows are always expanded on mobile */
        content: none;
        font-size: 0.85rem;
        line-height: 1;
        transition: transform 160ms ease;
        color: var(--text-color);
        opacity: 0.85;
        transform-origin: center;
    }

    tr.expanded .task-toggle::after {
        transform: rotate(180deg);
    }

    /* Drag column: keep compact and centered */
    .drag-column {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 28px;
        min-width: 28px;
        padding: 0 0.25rem;
    }

    /* Reduce icon sizes for compactness */
    .drag-handle i, .description-column .bi {
        font-size: 0.9rem;
    }

    /* Make badges smaller inside cards */
    .badge {
        padding: 0.18rem 0.35rem;
        font-size: 0.72rem;
    }
}

/* Touch & Tablet: ensure iPads and other touch devices use mobile-friendly layout
   Apply primarily by viewport width; limit aggressive feature queries so tablets
   in wide landscape don't get overly compact styles. */
@media (max-width: 1024px), (pointer: coarse) and (max-width: 1366px) {
    /* Make search form and add button scale nicely */
    /* Ensure the header controls can wrap instead of overlapping */
    .d-flex.justify-content-between.mb-4 {
        display: flex !important;
        flex-wrap: wrap;
        gap: 0.5rem;
        align-items: center;
    }

    #search-form {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        width: 100%;
        flex: 1 1 auto;
        min-width: 0; /* allow shrinking */
    }

    #search-form .search-input,
    #search-form .form-control.search-input {
        flex: 1 1 auto;
        min-width: 0; /* allows input to shrink inside flex */
        max-width: 100%;
        font-size: 0.98rem;
        padding: 0.45rem 0.6rem;
    }

    /* Keep the small search button and sidebar button compact */
    #search-form button {
        flex: 0 0 auto;
        padding: 0.35rem 0.55rem;
        font-size: 0.95rem;
        white-space: nowrap;
    }

    /* Cap the Add button so it doesn't expand to fill the row unexpectedly */
    #openSidebar {
        flex: 0 0 auto;
        max-width: 220px;
        padding: 0.45rem 0.8rem;
        white-space: nowrap;
        margin-left: 0.25rem;
    }

    /* Slightly reduce icon sizes for compactness */
    #search-form .bi,
    #openSidebar .bi {
        font-size: 1rem;
    }

}

/* Very narrow screens: stack search input and add button vertically */
@media (max-width: 420px) {
    #search-form {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        align-items: stretch;
    }
    #search-form .search-input { width: 100%; }
    #search-form button { width: 100%; }
    #openSidebar { width: 100%; max-width: none; }
}

/* Align Add button and Search box exactly on very small screens */
@media (max-width: 420px) {
    #search-form, #openSidebar {
        width: 100%;
        box-sizing: border-box;
        margin-left: 0 !important;
        margin-right: 0 !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
    }
    /* Ensure button visuals use full width and matching paddings */
    #search-form button, #openSidebar {
        width: 100% !important;
        padding-left: 0.6rem !important;
        padding-right: 0.6rem !important;
    }
}

/* Profile page: stack action buttons on small screens to match search/add layout */
@media (max-width: 420px) {
    body.profile-page .d-flex.gap-2 {
        display: flex !important;
        flex-direction: column !important;
        gap: 0.5rem !important;
        align-items: stretch !important;
    }
    body.profile-page .d-flex.gap-2 .btn,
    body.profile-page .d-flex.gap-2 a {
        width: 100% !important;
        box-sizing: border-box !important;
        padding-left: 0.6rem !important;
        padding-right: 0.6rem !important;
    }
}

/* Invite-list card polishing for small screens */
@media (max-width: 1024px) {
    .invite-list-card .table { border: none; }
    .invite-list-card .table td, .invite-list-card .table th { border: none; }
    .invite-list-card tbody tr {
        padding: 0.6rem 0.75rem;
        background: transparent;
        border-radius: 6px;
        box-shadow: none;
    }
    .invite-list-card .title-column {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        width: 100%;
    }
    .invite-list-card .title-column .form-control {
        flex: 1 1 auto;
        min-width: 0;
        margin: 0;
        background: var(--form-control-bg);
        color: var(--form-control-text);
        border: 1px solid var(--box-border);
        padding: 0.35rem 0.5rem;
    }
    .invite-list-card .title-column .task-toggle {
        margin-left: 0.25rem;
        padding: 0;
        background: transparent;
        border: none;
        color: var(--text-color);
        opacity: 0.95;
    }
    .invite-list-card .title-column .task-toggle::after {
        content: '\25BE';
        display: inline-block;
        margin-left: 0.25rem;
        transform-origin: center;
        transition: transform 150ms ease;
    }
    tr.expanded .invite-list-card .title-column .task-toggle::after { transform: rotate(180deg); }
    .invite-list-card .status-column, .invite-list-card .delete-column { display: inline-block; vertical-align: middle; }
    .invite-list-card .card-body .btn { margin-bottom: 0.35rem; }
}

/* Strong mobile (phones) adjustments to stack invite rows cleanly */
@media (max-width: 600px) {
    .invite-list-card .table { border: none; }
    .invite-list-card thead { display: none; }
    .invite-list-card tbody tr {
        display: block !important;
        padding: 0.6rem !important;
        margin-bottom: 0.6rem;
        background: var(--box-bg) !important;
        border: 1px solid var(--box-border) !important;
        border-radius: 6px !important;
        box-shadow: none !important;
    }

    /* Make each cell a block with its label above the value */
    .invite-list-card tbody tr td {
        display: block !important;
        width: 100% !important;
        padding: 0.35rem 0.45rem !important;
        border: none !important;
    }

    /* Hide details by default on very small screens; reveal when row is expanded.
       Use a more specific selector and !important so tablet/desktop rules don't override it. */
    .invite-list-card tbody tr:not(.expanded) .desc-column,
    .invite-list-card tbody tr:not(.expanded) .status-column,
    .invite-list-card tbody tr:not(.expanded) .delete-column {
        display: none !important;
    }

    .invite-list-card .title-column {
        display: block !important;
        width: 100% !important;
    }
    .invite-list-card .title-column .form-control {
        width: 100% !important;
        box-sizing: border-box !important;
    }

    /* Keep the toggle chevron aligned right on the same row as the email */
    .invite-list-card .title-column { position: relative; }
    .invite-list-card .title-column .task-toggle {
        position: absolute;
        right: 0.5rem;
        top: 50%;
        transform: translateY(-50%);
        padding: 0.15rem 0.35rem;
        background: transparent;
    }

    /* Token and status/actions stack below neatly */
    .invite-list-card .desc-column { margin-top: 0.45rem; word-break: break-all; }
    /* Reveal when expanded */
    .invite-list-card tbody tr.expanded .desc-column,
    .invite-list-card tbody tr.expanded .status-column,
    .invite-list-card tbody tr.expanded .delete-column {
        display: block !important;
        width: 100% !important;
        margin-top: 0.5rem !important;
    }

    /* Make action buttons full-width and touch-friendly */
    .invite-list-card .card-body .btn {
        width: 100% !important;
        padding: 0.6rem 0.8rem !important;
        box-sizing: border-box !important;
        margin-bottom: 0.4rem !important;
    }

    /* Reduce the token font slightly to avoid overflow */
    .invite-list-card .desc-column code { font-size: 0.92rem; }
}

/* Make profile card and form fields expand to full width on very small screens */
@media (max-width: 420px) {
    body.profile-page .container {
        padding-left: 0.5rem !important;
        padding-right: 0.5rem !important;
    }
    body.profile-page .row.justify-content-center {
        margin-left: 0 !important;
        margin-right: 0 !important;
    }
    body.profile-page .col-md-6 {
        flex: 0 0 100% !important;
        max-width: 100% !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
    }
    body.profile-page .card {
        width: 100% !important;
        max-width: 100% !important;
        box-sizing: border-box !important;
        margin: 0 auto !important;
    }
    body.profile-page .form-control,
    body.profile-page .form-select,
    body.profile-page .form-control-plaintext {
        width: 100% !important;
        box-sizing: border-box !important;
    }
    /* Slightly reduce the top margin on very small screens to keep content visible */
    body.profile-page .container.mt-5 { margin-top: 1.5rem !important; }
}

/* Tablet / touch devices: apply accordion/card table layout for iPads and similar */
@media (max-width: 1024px), (pointer: coarse) and (max-width: 1366px) {
    table { width: 100%; }
    thead { display: none; }

    tbody tr {
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 0.6rem;
        margin-bottom: 0.7rem;
        background-color: var(--box-bg);
        border: 1px solid var(--box-border);
        border-radius: 6px;
        padding: 0.5rem;
        box-shadow: 0 4px 8px rgba(0,0,0,0.06);
    }

    td {
        display: inline-block;
        padding: 0.18rem 0.35rem;
        position: relative;
        text-align: left;
        border: none;
        vertical-align: middle;
    }

    td::before {
        content: attr(data-label);
        display: block;
        font-weight: 600;
        margin-bottom: 0.25rem;
        color: #6c757d;
        font-size: 0.84rem;
    }

    [data-theme="dark"] td::before { color: #adb5bd; }

    .description-column { font-size: 1rem; font-weight: 700; }

    .description-column > .btn, .description-column > .btn-link {
        vertical-align: middle; display: inline-flex; align-items: center; padding: 0; margin-right: 0.35rem;
    }

    .date-added { font-size: 0.85rem; color: #6c757d; }
    [data-theme="dark"] .date-added { color: #adb5bd; }

    td[data-label="Status"], td[data-label="Delete"] { text-align: right; }

    .status-column, .delete-column { display: inline-block; margin-left: 0.35rem; padding: 0.28rem 0.5rem; font-size: 0.82rem; border-radius: 0.35rem; }

    .drag-column { display: inline-flex; align-items: center; justify-content: center; width: 32px; min-width: 32px; padding: 0 0.25rem; }

    .drag-handle { margin-right: 0.35rem; }

    /* COLLAPSED: hide details by default */
    td.desc-column, td.date-added, td[data-label="Status"], td[data-label="Delete"] { display: none; }

    td.title-column { display: inline-block; flex: 1 1 auto; }
    td.title-column::before { display: none; }

    /* Expanded state: show details below while keeping title+drag inline */
    tr.expanded { display: flex; flex-wrap: wrap; align-items: center; }
    tr.expanded td { display: inline-flex; align-items: center; }
    tr.expanded td.desc-column, tr.expanded td.date-added, tr.expanded td[data-label="Status"], tr.expanded td[data-label="Delete"] { display: block; flex-basis: 100%; width: 100%; padding-top: 0.5rem; }
    tr.expanded td.desc-column::before, tr.expanded td.date-added::before, tr.expanded td[data-label="Status"]::before, tr.expanded td[data-label="Delete"]::before { display: none; }

    /* Ensure expanded-state buttons on tablets also get full width */
/* Global task title toggle styling (all sizes) - remove link look and add affordance */
button.task-toggle, .task-toggle.btn, .task-toggle.btn-link, .task-toggle {
    -webkit-appearance: none !important;
    appearance: none !important;
    text-decoration: none !important;
    color: inherit !important;
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    font: inherit !important;
    line-height: inherit !important;
    padding: 0.08rem 0.18rem !important;
    margin: 0 !important;
    display: inline-flex !important;
    align-items: center !important;
    gap: 0.4rem !important;
    cursor: pointer !important;
    border-radius: 4px !important;
}

/* Final override: ensure on narrow phones the invite details remain hidden unless expanded.
   Placed at the end to outrank earlier tablet rules. */
@media (max-width: 600px) {
    .invite-list-card tbody tr:not(.expanded) td.desc-column,
    .invite-list-card tbody tr:not(.expanded) td.status-column,
    .invite-list-card tbody tr:not(.expanded) td.delete-column {
        display: none !important;
    }
    /* ensure the email/title row uses full width */
    .invite-list-card tbody tr td.title-column { display: block !important; width: 100% !important; }
}

button.task-toggle:hover, .task-toggle:hover, button.task-toggle:focus, .task-toggle:focus {
    background-color: rgba(0,0,0,0.04) !important;
    outline: none !important;
}

/* Chevron indicator for expansion on all sizes */
.task-toggle::after {
    content: '\25BE';
    font-size: 0.85rem;
    line-height: 1;
    transition: transform 160ms ease;
    color: var(--text-color);
    opacity: 0.85;
    transform-origin: center;
}

tr.expanded .task-toggle::after {
    transform: rotate(180deg);
}

    tbody tr.expanded td .status-column,
    tbody tr.expanded td .delete-column {
        display: block !important;
        width: 100% !important;
        padding: 0.5rem 0.6rem !important;
        font-size: 0.92rem !important;
        text-align: center !important;
        margin-left: 0 !important;
    }
}

/* Expandable box styles */

/* Strong override for mobile/tablet: force non-collapsible three-row layout
   for task/invite rows. This will ensure the Drag+Favorite+Title appear on
   the first row, Description on the second, and Actions on the third. It
   also removes the chevron indicator on small screens. Placed at the end
   so it outranks earlier accordion/collapse rules. */
@media (max-width: 900px) {
    /* remove chevron indicator everywhere on small screens */
    .task-toggle::after { content: none !important; display: none !important; }

    /* Ensure rows wrap so first line contains drag + title, others full width */
    tbody tr {
        display: flex !important;
        flex-wrap: wrap !important;
        align-items: center !important;
        gap: 0.5rem !important;
    }

    /* Title row: drag + favorite + title inline */
    td.drag-column { display: inline-flex !important; flex: 0 0 auto !important; }
    td.title-column { display: inline-flex !important; align-items: center !important; gap: 0.5rem !important; flex: 1 1 auto !important; min-width: 0 !important; }

    /* Make description, date and actions occupy full-width rows below */
    td.desc-column, td.date-added, td.actions-column, td[data-label="Status"], td[data-label="Delete"], .status-column, .delete-column {
        display: block !important;
        width: 100% !important;
        flex-basis: 100% !important;
        padding-top: 0.35rem !important;
        box-sizing: border-box !important;
    }

    /* Ensure invite-list-card specific selectors also show details */
    .invite-list-card tbody tr:not(.expanded) .desc-column,
    .invite-list-card tbody tr:not(.expanded) .status-column,
    .invite-list-card tbody tr:not(.expanded) .delete-column {
        display: block !important;
        width: 100% !important;
    }

    /* Tidy up action buttons spacing on small screens */
    .actions-column .d-flex, .actions-column .d-inline-flex {
        gap: 0.5rem !important;
        align-items: center !important;
    }

    .status-column, .delete-column {
        display: inline-flex !important;
        padding: 0.35rem 0.5rem !important;
        margin: 0 !important;
        font-size: 0.9rem !important;
        border-radius: 6px !important;
    }
}

/* Remove injected cell titles/labels on mobile and touch devices so each
   task row shows only the structured rows (drag+title, description, actions). */
@media (max-width: 900px), (pointer: coarse) {
    /* Hide content generated from data-label (td::before) across task/invite tables */
    table tbody tr td::before,
    .invite-list-card tbody tr td::before,
    td::before {
        display: none !important;
        content: none !important;
    }

    /* Also hide any .task-toggle pseudo-content used as chevrons */
    .task-toggle::after { display: none !important; content: none !important; }
}
.expandable-box {
    border: 1px solid var(--box-border);
    border-radius: 8px;
    box-shadow: 0 4px 8px var(--table-box-shadow);
    background-color: var(--box-bg);
    transition: background-color var(--transition-time), border-color var(--transition-time);
}

/* Header for expandable box */
.box-header {
    background-color: var(--table-header-bg);
    color: var(--table-header-text);
    font-size: 1.2em;
    font-weight: bold;
    cursor: pointer;
    transition: background-color var(--transition-time);
}

.box-header:hover {
    background-color: #0056b3; /* Matches Bootstrap's primary hover color */
}

/* Form styling */
.form-group {
    margin-bottom: 15px;
}

textarea {
    height: 80px;
    resize: none;
}

/* Button styles */
.btn-gradient {
    background: linear-gradient(
        45deg,
        #007bff,
        #0056b3
    ); /* Matches Bootstrap primary gradient */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.btn-gradient:hover {
    background: linear-gradient(45deg, #0056b3, #003f7f);
}

.btn-gradient:active {
    background: linear-gradient(45deg, #003f7f, #002b59);
}

/* Collapse styles */
.collapse {
    transition: height 0.3s ease-out;
}

/* Sidebar Styles */
#sidebar {
    position: fixed;
    top: 0;
    right: -400px; /* Hidden off-screen by default */
    height: 100%;
    width: 400px;
    background-color: var(--sidebar-bg);
    color: var(--text-color);
    box-shadow: -2px 0 5px var(--table-box-shadow);
    transition: right 0.3s ease, background-color var(--transition-time), color var(--transition-time); 
    z-index: 1040;
    overflow-y: auto;
}

#sidebar.active {
    right: 0; /* Slide into view when active */
}

#sidebar .sidebar-header {
    padding: 1.5rem;
    border-bottom: 1px solid var(--box-border);
    transition: border-color var(--transition-time);
}

#sidebar .sidebar-body {
    padding: 1rem;
}

[data-theme="dark"] #sidebar .sidebar-header {
    border-bottom-color: #444;
}

[data-theme="dark"] #sidebar label {
    color: var(--text-color);
}

[data-theme="dark"] #sidebar .form-hint {
    color: #adb5bd;
}

/* Theme toggle button styles */
.theme-toggle {
    cursor: pointer;
    width: 50px;
    height: 25px;
    background-color: #ccc;
    display: inline-block;
    border-radius: 25px;
    position: relative;
    transition: 0.3s;
    box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
}

.theme-toggle:before {
    content: '';
    position: absolute;
    width: 21px;
    height: 21px;
    border-radius: 50%;
    top: 2px;
    left: 2px;
    background-color: white;
    transition: 0.3s;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}

.theme-toggle.active {
    background-color: #0d6efd;
}

.theme-toggle.active:before {
    transform: translateX(25px);
}

/* Icon colors for light/dark mode indicators */
[data-theme="light"] .bi-sun-fill {
    color: #fd7e14;
}

[data-theme="light"] .bi-moon-fill {
    color: #6c757d;
}

[data-theme="dark"] .bi-sun-fill {
    color: #6c757d;
}

[data-theme="dark"] .bi-moon-fill {
    color: #f8f9fa;
}

/* Ensure navbar controls wrap and don't overflow on compact screens */
.navbar .container {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}
.navbar .navbar-brand {
    flex: 0 0 auto;
}
.navbar .navbar-collapse.collapse.show {
    flex: 1 1 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    min-width: 0; /* allow children to shrink */
}
.navbar .navbar-nav {
    flex: 0 0 auto;
}
.navbar .navbar-collapse > .d-flex {
    flex: 0 1 auto;
    min-width: 0;
    flex-wrap: wrap; /* allow profile/logout to wrap to next line */
    gap: 0.35rem;
    justify-content: flex-end;
}
.navbar .text-muted {
    max-width: 160px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    display: inline-block;
}

/* When viewport is very narrow, move profile/logout onto their own row */
@media (max-width: 520px) {
    .navbar .navbar-collapse {
        flex-direction: column;
        align-items: stretch;
        gap: 0.35rem;
    }
    .navbar .navbar-collapse > .d-flex {
        justify-content: flex-start;
        width: 100%;
    }
    .navbar .navbar-collapse .btn {
        flex: 0 0 auto;
    }
}

/* Dark mode overrides for form controls */
[data-theme="dark"] .form-control {
    background-color: var(--form-control-bg);
    color: var(--form-control-text);
    border-color: #444;
}

[data-theme="dark"] .form-control:focus {
    background-color: #444;
    color: #fff;
    border-color: #0d6efd;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
}

[data-theme="dark"] .form-control::placeholder {
    color: #adb5bd;
}

[data-theme="dark"] .navbar {
    background-color: var(--navbar-bg) !important;
}

[data-theme="dark"] .navbar-brand,
[data-theme="dark"] .nav-link {
    color: var(--navbar-text) !important;
}

[data-theme="dark"] .container {
    background-color: var(--container-bg);
}

[data-theme="dark"] .modal-content {
    background-color: var(--sidebar-bg);
    color: var(--text-color);
}

/* Ensure inline email inputs in invite rows are readable and accessible
   when using the compact/accordion layout (title-column). */
.title-column .form-control,
.title-column input[type="email"] {
    background-color: var(--form-control-bg);
    color: var(--form-control-text);
    border: 1px solid var(--box-border);
    padding: 0.25rem 0.45rem;
}

.title-column .form-control::placeholder,
.title-column input[type="email"]::placeholder {
    color: rgba(0,0,0,0.45);
}

[data-theme="dark"] .title-column .form-control::placeholder,
[data-theme="dark"] .title-column input[type="email"]::placeholder {
    color: #adb5bd;
}

/* Give a little breathing room between the input and the compact toggle */
.title-column .task-toggle {
    margin-left: 0.5rem;
}

[data-theme="dark"] .card {
    background-color: var(--sidebar-bg);
    color: var(--text-color);
    border-color: #444;
}

/* Search input styling */
.search-input {
    transition: box-shadow 0.3s ease, border-color 0.3s ease;
}

.search-input:focus {
    border-color: #0d6efd;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
}

[data-theme="dark"] .search-input::placeholder {
    color: #adb5bd;
}

/* Container styling for dark mode */
[data-theme="dark"] .container {
    background-color: var(--container-bg);
}

/* Navbar styling */
.navbar {
    background-color: var(--navbar-bg);
    transition: background-color var(--transition-time);
    padding: 1rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.navbar-brand, .nav-link {
    color: var(--navbar-text);
    transition: color var(--transition-time);
}

.navbar-brand:hover, .nav-link:hover {
    color: #0d6efd;
}

[data-theme="dark"] .navbar {
    background-color: var(--navbar-bg) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

[data-theme="dark"] .navbar-brand,
[data-theme="dark"] .nav-link {
    color: var(--navbar-text) !important;
}

[data-theme="dark"] .navbar-toggler-icon {
    filter: invert(1);
}

/* Status notification styling */
.status-notification {
    background-color: #d4edda;
    color: #155724;
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #c3e6cb;
    border-radius: 4px;
    transition: background-color var(--transition-time), 
                color var(--transition-time), 
                border-color var(--transition-time);
}

[data-theme="dark"] .status-notification {
    background-color: #2a3b2e;
    color: #8fd19e;
    border-color: #3d5641;
}

/* Table overrides for dark mode */
[data-theme="dark"] .table {
    color: var(--text-color);
}

[data-theme="dark"] .table-striped > tbody > tr:nth-of-type(odd) {
    background-color: #1a1a1a;
    color: var(--text-color);
}

[data-theme="dark"] .table-striped > tbody > tr:nth-of-type(even) {
    color: var(--text-color);
}

[data-theme="dark"] .table-bordered,
[data-theme="dark"] .table-bordered th,
[data-theme="dark"] .table-bordered td {
    border-color: #444;
}

/* Button styling for dark mode */
[data-theme="dark"] .btn-outline-primary {
    color: #6ea8fe;
    border-color: #6ea8fe;
}

[data-theme="dark"] .btn-outline-primary:hover:not([disabled]) {
    background-color: #0d6efd;
    color: #fff;
}

/* Modal dark mode */
[data-theme="dark"] .modal-header,
[data-theme="dark"] .modal-footer {
    border-color: #444;
}

[data-theme="dark"] .btn-close {
    filter: invert(1) grayscale(100%) brightness(200%);
}

/* Remove grey background around task container */
.container {
    background-color: transparent !important;
    transition: background-color var(--transition-time);
}

/* Only apply specific container backgrounds where needed */
[data-theme="dark"] .status-notification {
    background-color: #2a3b2e;
}

/* Keep the search container styling */
.container.mt-3.rounded.p-3 {
    background-color: transparent !important;
    box-shadow: none !important;
}

/* Ensure table cells follow text color */
[data-theme="dark"] .table td,
[data-theme="dark"] .table th {
    color: var(--text-color);
}

/* Make "No tasks available" message visible in dark mode */
[data-theme="dark"] .table .text-center {
    color: var(--text-color);
}

/* Fix text coloring in status badges */
[data-theme="dark"] .badge {
    color: white;
}

/* Fix "Page X" text visibility in dark mode */
[data-theme="dark"] .text-muted {
    color: #adb5bd !important;
}

/* Table row text color fix for dark mode */
[data-theme="dark"] .table-striped > tbody > tr,
[data-theme="dark"] .table-striped > tbody > tr:nth-of-type(odd),
[data-theme="dark"] .table-striped > tbody > tr:nth-of-type(even),
[data-theme="dark"] .table > tbody > tr {
    color: var(--text-color) !important;
}

/* Optionally, make the striped row background a bit lighter for contrast */
[data-theme="dark"] .table-striped > tbody > tr:nth-of-type(odd) {
    background-color: #23272b !important;
}
[data-theme="dark"] .table-striped > tbody > tr:nth-of-type(even) {
    background-color: #181a1b !important;
}

[data-theme="dark"] .table-striped > tbody > tr > td,
[data-theme="dark"] .table-striped > tbody > tr > th,
[data-theme="dark"] .table > tbody > tr > td,
[data-theme="dark"] .table > tbody > tr > th {
    color: var(--text-color) !important;
}

[data-theme="dark"] .table-striped > tbody > tr > td *,
[data-theme="dark"] .table-striped > tbody > tr > th *,
[data-theme="dark"] .table > tbody > tr > td *,
[data-theme="dark"] .table > tbody > tr > th * {
    color: var(--text-color) !important;
}

mark {
    background-color: #ffe066;
    color: #212529;
    padding: 0 0.15em;
    border-radius: 0.2em;
}

[data-theme="dark"] mark {
    background-color: #ffd43b;
    color: #222;
    padding: 0 0.15em;
    border-radius: 0.2em;
}

/* Ensure borders within the table adapt to dark mode */
[data-theme="dark"] td,
[data-theme="dark"] th {
    border-bottom: 1px solid var(--box-border);
}

[data-theme="dark"] .table-bordered,
[data-theme="dark"] .table-bordered th,
[data-theme="dark"] .table-bordered td {
    border-color: var(--box-border);
}

/* Enhance hover for buttons */
.btn {
    transition: background-color var(--transition-time), color var(--transition-time), border-color var(--transition-time), box-shadow var(--transition-time);
}

.btn-outline-primary:hover:not([disabled]) {
     box-shadow: 0 2px 5px rgba(0, 123, 255, 0.3); /* Add subtle shadow on hover */
}

[data-theme="dark"] .btn-outline-primary:hover:not([disabled]) {
     box-shadow: 0 2px 5px rgba(13, 110, 253, 0.4); /* Dark mode shadow */
}

/* Add transition to links */
a {
    transition: color var(--transition-time);
}

/* Toast notification styles */
.app-toast-container {
    position: fixed;
    right: 1rem;
    top: 1rem;
    z-index: 2000;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    pointer-events: none; /* allow clicks through gaps */
}

.app-toast {
    pointer-events: auto;
    min-width: 220px;
    max-width: 360px;
    padding: 0.6rem 0.9rem;
    border-radius: 8px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.2);
    font-size: 0.95rem;
    line-height: 1.2;
    opacity: 0;
    transform: translateY(-8px);
    transition: opacity 200ms ease, transform 200ms ease;
    border: 1px solid rgba(0,0,0,0.08);
}

.app-toast.show {
    opacity: 1;
    transform: translateY(0);
}

/* Light theme */
[data-theme="light"] .app-toast {
    background-color: #ffffff;
    color: #212529;
    border-color: #dcdcdc;
}

/* Dark theme */
[data-theme="dark"] .app-toast {
    background-color: #1f1f1f;
    color: #f1f3f5;
    border-color: #333;
}

/* Slight variation for error/toast importance */
.app-toast--error {
    border-left: 4px solid #dc3545;
}

/* Small, scoped style for changelog release tag badges */
.releasetag {
    font-size: 0.82rem;
    padding: 0.12rem 0.4rem;
    border-radius: 0.35rem;
    line-height: 1;
}

/* Slightly reduce prominence of warning badge when using releasetag */
.releasetag.bg-warning {
    box-shadow: none;
}

/* Theme-aware dropdown (select) styling to match light/dark mode */
.form-select,
select.form-select {
    background-color: var(--form-control-bg);
    color: var(--form-control-text);
    border: 1px solid var(--box-border);
    transition: background-color var(--transition-time), color var(--transition-time), border-color var(--transition-time), box-shadow var(--transition-time);
}

.form-select:focus,
select.form-select:focus {
    outline: none;
    border-color: var(--table-header-bg);
    box-shadow: 0 0 0 0.2rem rgba(13,110,253,0.18);
}

/* Slightly darker placeholder in dark mode for contrast */
::placeholder {
    color: rgba(0,0,0,0.45);
}
[data-theme="dark"] ::placeholder {
    color: rgba(255,255,255,0.55);
}

/* Ensure select caret and appearance remain native on different platforms */
.form-select {
    -webkit-appearance: menulist-button;
    appearance: menulist-button;
}

